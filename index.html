<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>💖</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;600;800&family=Pacifico&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#ffefef;
      --bg2:#fff1f8;
      --accent:#ff3b6b;
      --card:#ffffffcc;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Montserrat,system-ui,Segoe UI,Roboto,sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem}
    .card{width:100%;max-width:900px;background:var(--card);backdrop-filter: blur(6px);border-radius:20px;padding:2rem;box-shadow:0 10px 30px rgba(0,0,0,0.08);position:relative;overflow:hidden}
    header{display:flex;gap:1rem;align-items:center}
    .avatar{width:84px;height:84px;border-radius:50%;background:linear-gradient(180deg,#fff,#ffeef4);display:flex;align-items:center;justify-content:center;font-family:Pacifico;font-size:28px;color:var(--accent);border:4px solid #fff}
    h1{margin:0;font-size:28px;color:#333}
    p.lead{margin:0.4rem 0 1rem;color:#6b5870}

    .stage{display:grid;grid-template-columns:1fr 320px;gap:1.5rem;align-items:center}
    .left{padding:1rem}
    .note{font-size:18px;line-height:1.5;color:#422a3a}
    .typewriter{font-family:Pacifico;font-size:34px;color:var(--accent);margin-top:1rem;min-height:40px}

    .right{display:flex;flex-direction:column;gap:1rem}
    .btn{background:var(--accent);color:#fff;padding:12px 16px;border-radius:12px;border:0;font-weight:700;cursor:pointer;box-shadow:0 8px 18px rgba(255,59,107,0.18)}
    .btn.secondary{background:transparent;color:var(--accent);border:2px solid rgba(255,59,107,0.12)}

    .photo{width:100%;height:220px;border-radius:14px;object-fit:contain;background:linear-gradient(180deg,#ffdfe8,#fff)}
    .hearts{position:absolute;inset:0;pointer-events:none}

    .heart{position:absolute;width:28px;height:28px;background:var(--accent);transform:rotate(45deg);border-radius:6px;opacity:0.9}
    .heart:before,.heart:after{content:'';position:absolute;background:var(--accent);width:28px;height:28px;border-radius:50%}
    .heart:before{top:-14px;left:0}
    .heart:after{left:14px;top:0}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .25s}
    .modal.open{opacity:1;pointer-events:auto}
    .modal-card{background:#fff;border-radius:16px;padding:1.6rem;max-width:680px;width:100%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.18)}
    .surprise-msg{font-size:20px;color:#444;line-height:1.5}
    .big-heart{font-size:48px;margin:0.6rem 0;color:var(--accent)}

    footer{display:flex;gap:0.5rem;justify-content:center;margin-top:1rem}

    /* tap-to-start overlay */
    .tap-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(255,255,255,0.0),rgba(255,255,255,0.2));z-index:60;backdrop-filter: blur(0px);}
    .tap-card{background:rgba(255,255,255,0.9);padding:18px 22px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.12);font-size:16px;color:#333}

    @media(max-width:820px){.stage{grid-template-columns:1fr;}.right{order:-1}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="hearts" id="hearts"></div>
      <header>
        <div class="avatar">💌</div>
        <div>
          <h1>For the most beautiful person in my life</h1>
          <p class="lead">A tiny surprise to make your day sweeter ✨</p>
        </div>
      </header>

      <div class="stage">
        <div class="left">
          <div class="typewriter" id="tw">Hey ❤️</div>
          <p class="note">Open the surprise when you're ready. I made this just for you — Thoda silly hai but ab jaisa bhi hai yahi hai 😁. Also just vichar kela tula thoda entertain karu aur more like disturb karu 😜</p>

          <div style="display:flex;gap:0.6rem;margin-top:1rem;flex-wrap:wrap">
            <button class="btn" id="openBtn">Open Surprise</button>
            
          </div>
        </div>

        <div class="right">
          <img class="photo" id="photo" src="pic.jpeg" alt="photo" />
        </div>
      </div>

      <footer>
        <small style="color:#8a6f7f">Made with lots of... 💕</small>
      </footer>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="big-heart">💖</div>
      <div class="surprise-msg" id="surpriseText">
        😊 Arranged marriage sounds like a setup, but I think we’re making it the cutest setup ever. <br/>PS: you better get used to my silly surprises 😁. <br/>Sagla khup new new ahe ani ajun khup initial phase la ahe but I am enjoying this. I mean baghta baghta almost month zala hi, and mala literally atach realise zal ha ki its almost month now.<br/>Nahi nahi mi kay monthly dates celebrate karnari mulgi nahi ahe. So tension nko gheus 😅. It's just meine socha tumko thoda special feel karaya jaaye 😜 ata hey sagla mi plain whatsapp message var send karu shakat hoti but funnnn kidhar hai usme...
        So let's come back to point. kuthey hoti mi... ha, so I know delhi abhi dur hai and apan dogha hi ajun far kahi ekmekana nahi olkhat but am glad it’s you I get to know. <br/>
        I’m looking forward to every laugh, every chai, and every story we’ll share. Thoda filmy ho gaya na...hmm but ab writing ka keeda hai mujhme toh thoda filmy toh banta hai re babumoshai...
      </div>
      <div style="margin-top:1rem">
        <button class="btn" id="closeModal">Close</button>
      </div>
    </div>
  </div>

  <!-- audio: put your music file in the same folder as this HTML and set music.src = 'mysong.mp3' in the script below -->
  <audio id="music" loop src=""></audio>

  <!-- simple overlay that invites one tap if autoplay is blocked (will hide when music starts) -->
  <div class="tap-overlay" id="tapOverlay" style="display:none">
    <div class="tap-card">Tap anywhere to start the music 🎵</div>
  </div>

  <canvas id="confetti" style="position:fixed;pointer-events:none;inset:0;z-index:40;display:none"></canvas>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
    // hearts
    const heartsContainer = document.getElementById('hearts');
    function spawnHeart(){
      const h = document.createElement('div');
      h.className='heart';
      const size = 18 + Math.random()*26;
      h.style.width = size+'px'; h.style.height = size+'px';
      h.style.left = Math.random()*100+'%';
      h.style.bottom = '-40px';
      h.style.opacity = (0.5 + Math.random()*0.7).toString();
      heartsContainer.appendChild(h);
      h.animate([
        {transform: 'translateY(0) scale(1)', opacity:h.style.opacity},
        {transform: `translateY(-${200+Math.random()*400}px) scale(1.1)`, opacity:0}
      ],{duration:5000 + Math.random()*6000, easing:'ease-out'}).onfinish = ()=> h.remove();
    }
    setInterval(spawnHeart, 700);

    // typewriter
    const tw = document.getElementById('tw');
    const lines = [
      "Hey ❤️",
      "Excited to know you more!",
      "Looking forward to our new journey.",
      "Every chai together will be special.",
      "Silly surprises incoming 😁"
    ];
    let idx=0;
    function typeLoop(){
      const txt = lines[idx%lines.length];
      tw.textContent='';
      let i=0;
      const t = setInterval(()=>{
        tw.textContent += txt[i++]||'';
        if(i>txt.length){ clearInterval(t); setTimeout(()=>{ idx++; typeLoop(); },1200); }
      },80);
    }
    typeLoop();

    // modal + confetti
    const openBtn = document.getElementById('openBtn');
    const modal = document.getElementById('modal');
    const closeModal = document.getElementById('closeModal');
    const confettiCanvas = document.getElementById('confetti');
    let confettiActive=false;

    openBtn.addEventListener('click', ()=>{ modal.classList.add('open'); startConfetti(); });
    closeModal.addEventListener('click', ()=>{ modal.classList.remove('open'); stopConfetti(); });

    let ctx, W, H, pieces=[];
    function initConfetti(){
      confettiCanvas.style.display='block';
      W=confettiCanvas.width = innerWidth; H=confettiCanvas.height = innerHeight; ctx=confettiCanvas.getContext('2d');
      pieces = [];
      for(let i=0;i<120;i++){ pieces.push({x:Math.random()*W,y:Math.random()*H*0.5 - H, r:Math.random()*8+4, d:Math.random()*50+10, color:['#ff6b8a','#ffd6e0','#ffb3c7','#ffc8d9'][Math.floor(Math.random()*4)], tilt:Math.random()*10-10}); }
      confettiActive=true; drawConfetti();
    }
    function drawConfetti(){
      if(!confettiActive) return ctx.clearRect(0,0,W,H), confettiCanvas.style.display='none';
      ctx.clearRect(0,0,W,H);
      for(let i=0;i<pieces.length;i++){
        const p = pieces[i];
        ctx.fillStyle = p.color;
        ctx.beginPath(); ctx.ellipse(p.x,p.y,p.r, p.r*0.6, p.tilt, 0, Math.PI*2); ctx.fill();
        p.x += Math.sin(p.d) + 0.5; p.y += 2 + Math.cos(p.d);
        if(p.y>H+20){ p.x = Math.random()*W; p.y = -20; }
      }
      requestAnimationFrame(drawConfetti);
    }
    function startConfetti(){ if(!confettiActive) initConfetti(); }
    function stopConfetti(){ confettiActive=false; }

    // audio handling: autoplay attempt + tap-to-start fallback
    const music = document.getElementById('music');
    const tapOverlay = document.getElementById('tapOverlay');

    // === EDIT THIS: set your music file name or URL here ===
    // If the file is in the same folder as this HTML, set to 'mysong.mp3'
    // Or set to a full URL: 'https://example.com/mysong.mp3'
    music.src = 'https://heemali625.github.io/surprise-page/song.mp3'; // test file (public direct mp3) - replace with your own file or URL
    // ======================================================

    // ensure AudioContext available/resumed on mobile
    function ensureAudioContext(){ if(!window.AUDIOCTX) window.AUDIOCTX = new (window.AudioContext || window.webkitAudioContext)(); const actx = window.AUDIOCTX; if(actx.state === 'suspended') return actx.resume(); return Promise.resolve(); }

    // play fallback short melody
    function playFallbackMelody(){ ensureAudioContext().then(()=>{
      const actx = window.AUDIOCTX; const now = actx.currentTime; const o = actx.createOscillator(); const g = actx.createGain(); o.connect(g); g.connect(actx.destination); o.type='sine'; g.gain.setValueAtTime(0.0001, now); const freqs=[440,550,660,880]; freqs.forEach((f,i)=>{ o.frequency.setValueAtTime(f, now + i*0.18); g.gain.linearRampToValueAtTime(0.12, now + i*0.02 + 0.02); }); o.start(now); setTimeout(()=>{ try{ o.stop(); }catch(e){} },900);
    }).catch(e=>console.warn(e)); }

    // try to play music; returns Promise<boolean> resolved true if played
    function tryPlayMusic(){
      return ensureAudioContext().then(()=>{
        if(!music.src || music.src.trim()===''){
          playFallbackMelody();
          return Promise.resolve(false);
        }
        return music.play().then(()=>{ tapOverlay.style.display='none'; return true; }).catch(err=>{
          console.warn('Autoplay blocked or failed:', err);
          // show overlay to let user tap once
          tapOverlay.style.display='flex';
          return false;
        });
      }).catch(err=>{ console.warn(err); playFallbackMelody(); return false; });
    }

    // attempt autoplay on load
    window.addEventListener('load', ()=>{
      tryPlayMusic();
    });

    // if overlay visible, tapping anywhere will start music (user gesture)
    function startOnTap(){
      ensureAudioContext().then(()=>{
        music.play().then(()=>{ tapOverlay.style.display='none'; }).catch(err=>{ console.warn('Play on tap failed:', err); playFallbackMelody(); tapOverlay.style.display='none'; });
      });
    }
    tapOverlay.addEventListener('click', startOnTap);
    // also allow single tap anywhere as fallback
    document.addEventListener('click', function oneClickStart(){
      if(tapOverlay.style.display==='flex' || !music.paused){ startOnTap(); document.removeEventListener('click', oneClickStart); }
    });

    // download, drag-drop, modal and other handlers remain unchanged
    document.getElementById('downloadBtn').addEventListener('click', async ()=>{
      const card = document.querySelector('.card');
      const rect = card.getBoundingClientRect();
      const canvas = document.createElement('canvas'); canvas.width = rect.width*2; canvas.height = rect.height*2;
      const ctx2 = canvas.getContext('2d'); ctx2.scale(2,2);
      ctx2.fillStyle='#fff'; ctx2.fillRect(0,0,rect.width,rect.height);
      ctx2.fillStyle='#422a3a'; ctx2.font='18px Montserrat'; ctx2.fillText('A little keepsake — open this page in a browser and take a screenshot for a perfect image!',20,40);
      const data = canvas.toDataURL('image/png');
      const a = document.createElement('a'); a.href=data; a.download='for_my_fiancee.png'; a.click();
    });

    document.addEventListener('keydown',(e)=>{ if(e.key==='Escape') modal.classList.remove('open'); });

    const photo = document.getElementById('photo');
    photo.addEventListener('dragover', (e)=>{ e.preventDefault(); photo.style.opacity=0.8; });
    photo.addEventListener('dragleave', ()=>{ photo.style.opacity=1; });
    photo.addEventListener('drop',(e)=>{
      e.preventDefault(); photo.style.opacity=1; const f = e.dataTransfer.files && e.dataTransfer.files[0];
      if(f && f.type.startsWith('image/')){ const r = new FileReader(); r.onload = ()=> photo.src = r.result; r.readAsDataURL(f); }
    });

    document.getElementById('surpriseText').addEventListener('click', ()=>{
      const newMsg = prompt('Write a short personal message (keep it under 300 chars):', document.getElementById('surpriseText').innerText);
      if(newMsg!==null) document.getElementById('surpriseText').innerText = newMsg;
    });
      });
  </script>
</body>
</html>




